---
--- Generated by Luanalysis
--- Created by Аlex Bayir.
--- DateTime: 09.01.2022 16:53
---

version="1.6"
domain="mangalib.me"
source="MangaLib"
Type="Manga"
description="Один из самых популярных источников манги в СНГ."
host="https://"..domain
auth_tokens={"mangalib_session","XSRF-TOKEN"}
icon=host.."/icons/icon-192x192.png"

Sorts={["По рейтингу"]="rating_score", ["По количеству оценок"]="rate", ["По названию"]="name", ["По дате обновлениям"]="last_chapter_at",["По дате добавления"]="created_at",["По просмотрам"]="views",["По количеству глав"]="chap_count"}
sorts={[1]="rate",[2]="created_at",[3]="last_chapter_at"}
Order={["По убыванию"]="desc",["По возрастанию"]="asc"}
Genres={["Арт"]="32",["Безумие"]="91",["Боевик"]="34",["Боевые искусства"]="35",["Вампиры"]="36",["Военное"]="89",["Гарем"]="37",["Гендерная интрига"]="38",["Героическое фэнтези"]="39",["Демоны"]="81",["Детектив"]="40",["Детское"]="88",["Дзёсэй"]="41",["Драма"]="43",["Игра"]="44",["Исекай"]="79",["История"]="45",["Киберпанк"]="46",["Кодомо"]="76",["Комедия"]="47",["Космос"]="83",["Магия"]="85",["Махо-сёдзё"]="48",["Машины"]="90",["Меха"]="49",["Мистика"]="50",["Музыка"]="80",["Научная фантастика"]="51",["Омегаверс"]="77",["Пародия"]="86",["Повседневность"]="52",["Полиция"]="82",["Постапокалиптика"]="53",["Приключения"]="54",["Психология"]="55",["Романтика"]="56",["Самурайский боевик"]="57",["Сверхъестественное"]="58",["Сёдзё"]="59",["Сёдзё-ай"]="60",["Сёнэн"]="61",["Сёнэн-ай"]="62",["Спорт"]="63",["Супер сила"]="87",["Сэйнэн"]="64",["Трагедия"]="65",["Триллер"]="66",["Ужасы"]="67",["Фантастика"]="68",["Фэнтези"]="69",["Школа"]="70",["Эротика"]="71",["Этти"]="72",["Юри"]="73",["Яой"]="74"}
Tags={["Азартные игры"]="304",["Алхимия"]="225",["Амнезия \\ Потеря памяти"]="347",["Ангелы"]="226",["Антигерой"]="175",["Антиутопия"]="227",["Апокалипсис"]="228",["Армия"]="229",["Артефакты"]="230",["Боги"]="215",["Бои на мечах"]="231",["Борьба за власть"]="232",["Брат и сестра"]="233",["Будущее"]="234",["Ведьма"]="338",["Вестерн"]="235",["Видеоигры"]="185",["Виртуальная реальность"]="195",["Владыка демонов"]="236",["Военные"]="179",["Война"]="237",["Волшебники \\ маги"]="281",["Волшебные существа"]="239",["Воспоминания из другого мира"]="240",["Выживание"]="193",["ГГ женщина"]="243",["ГГ имба"]="291",["ГГ мужчина"]="244",["Геймеры"]="241",["Гильдии"]="242",["Глупый ГГ"]="297",["Гоблины"]="245",["Горничные"]="169",["Гяру"]="178",["Демоны"]="151",["Драконы"]="246",["Дружба"]="247",["Жестокий мир"]="249",["Животные компаньоны"]="250",["Завоевание мира"]="251",["Зверолюди"]="162",["Злые духи"]="252",["Зомби"]="149",["Игровые элементы"]="253",["Империи"]="254",["Квесты"]="255",["Космос"]="256",["Кулинария"]="152",["Культивация"]="160",["Легендарное оружие"]="257",["Лоли"]="187",["Магическая академия"]="258",["Магия"]="168",["Мафия"]="172",["Медицина"]="153",["Месть"]="259",["Монстродевушки"]="188",["Монстры"]="189",["Музыка"]="357",["Навыки \\ способности"]="260",["Насилие \\ жестокость"]="262",["Наёмники"]="261",["Нежить"]="263",["Ниндзя"]="180",["Обмен телами"]="346",["Обратный Гарем"]="191",["Огнестрельное оружие"]="264",["Офисные Работники"]="181",["Пародия"]="265",["Пираты"]="340",["Подземелья"]="266",["Политика"]="267",["Полиция"]="182",["Преступники \\ Криминал"]="186",["Призраки \\ Духи"]="177",["Путешествие во времени"]="194",["Рабы"]="354",["Разумные расы"]="268",["Ранги силы"]="248",["Реинкарнация"]="148",["Роботы"]="269",["Рыцари"]="270",["Самураи"]="183",["Система"]="271",["Скрытие личности"]="273",["Спасение мира"]="274",["Спортивное тело"]="334",["Средневековье"]="173",["Стимпанк"]="272",["Супергерои"]="275",["Традиционные игры"]="184",["Умный ГГ"]="302",["Учитель \\ ученик"]="276",["Философия"]="277",["Хикикомори"]="166",["Холодное оружие"]="278",["Шантаж"]="279",["Эльфы"]="216",["Якудза"]="164",["Яндере"]="368",["Япония"]="280"}
Series={["Accel World"]="1",["Sword Art Online"]="2",["Akame ga Kill"]="3",["Ao no Exorcist"]="4",["Angel Beats"]="5",["Another"]="6",["Ansatsu Kyoushitsu"]="7",["Azur lane"]="8",["Bakemonogatari"]="9",["Black Rock Shooter"]="10",["Berserk"]="11",["Boku no Hero Academia"]="12",["Clannad"]="13",["Code Geass"]="14",["D.Gray-man"]="15",["Danganronpa"]="16",["Darling In The Franxx"]="17",["Date A Live"]="18",["Death Note"]="19",["Dumbbell Nan Kilo Moteru"]="20",["Elfen Lied"]="21",["Fairy Tail"]="22",["Fullmetal Alchemist"]="23",["Gintama"]="24",["Hibike! Euphonium"]="25",["Mob Psycho 100"]="26",["Welcome to the N.H.K."]="27",["One Punch Man"]="28",["One Piece"]="29",["Owari no Seraph"]="30",["Psycho-Pass"]="31",["Bleach"]="32",["Love Live!"]="33",["Ookiku Furikabutte"]="34",["Fate Grand Order"]="35",["Yuri on Ice"]="36",["Dramatical Murder"]="37",["Durarara!!"]="38",["Kuroko no basket"]="39",["Fate stay night"]="40",["Bungou stray dogs"]="41",["Haikyuu!!"]="42",["Shingeki no Kyojin"]="43",["Tokyo Ghoul"]="44",["Yu-Gi-Oh!"]="45",["Final Fantasy"]="46",["Hetalia"]="47",["Re: Zero kara Hajimeru Isekai Seikatsu"]="48",["Free!"]="49",["Rainbow Six"]="50",["Daiya no Ace"]="51",["Kimi to Boku"]="52",["Sekaiju no Meikyuu"]="53",["Jikkyou Powerful Pro Yakyuu"]="54",["Genshin Impact"]="55",["Naruto"]="56",["Dragon Ball"]="57",["Highschool of the Dead"]="59",["A-Channel"]="60",["Ace Attorney"]="61",["Adventure Time"]="62",["Agent Aika"]="63",["Aggretsuko"]="64",["Ah! My Goddess"]="65",["Ai Yori Aoshi"]="66",["Aikatsu!"]="67",["Aladdin"]="69",["Alice Gear Aegis"]="70",["Alice in Wonderland"]="71",["Amaama To Inazuma"]="72",["Amagami"]="73",["Amagi Brilliant Park"]="75",["Amano Megumi Ha Sukidarake!"]="76",["American Dad!"]="77",["American McGee's Alice"]="78",["Anarchy Reigns"]="79",["Anedoki"]="82",["Animal Crossing"]="83",["Ano Hi Mita Hana no Namae o Boku-tachi wa Mada Shiranai"]="84",["Ano Natsu de Matteru"]="85",["Aoi hana"]="86",["Aquarion Evol"]="87",["Arcana Heart"]="88",["Aria"]="89",["Arknights"]="90",["Armored Trooper VOTOMS"]="91",["Arpeggio of Blue Steel"]="92",["Arslan Senki"]="93",["Ashitaba-san Chi No Mukogurashi"]="94",["Asobi ni Iku yo!"]="95",["Assassin's Creed"]="96",["Atomic Betty"]="98",["Avatar: the Last Airbender"]="99",["Azumanga Daioh"]="101",["Goblin Slayer"]="102",["Hypnosis Mic"]="103",["Steven Universe"]="104",["Infinite Stratos"]="105",["Go-Toubun no Hanayome"]="106",["To Love-Ru"]="107",["Bloodborne"]="108",["Kimetsu no Yaiba"]="109",["Tejina-senpai"]="110",["Darker than Black"]="111",["Chuunibyou demo Koi ga Shitai"]="112",["Kaguya-sama Wa Kokurasetai - Tensai-tachi no Renai Zunousen"]="113",["Little Witch Academia"]="114",["Dungeon ni Deai wo Motomeru no wa Machigatteiru Darou ka"]="115",["Kono Subarashii Sekai ni Shukufuku wo!"]="116",["Seishun Buta Yarou wa Bunny Girl Senpai no Yume wo Minai"]="117",["NieR: Automata"]="118",["Transformers"]="119",["Yowamushi Pedal"]="120",["League of Legends"]="121",["Drifters"]="122",["JoJo’s Bizarre Adventure"]="123",["Detective Conan"]="124",["Tiger & Bunny"]="125",["Neon Genesis Evangelion"]="126",["Kill La Kill"]="127",["Uta no Prince-sama"]="128",["Bishoujo Senshi Sailormoon"]="129",["Chainsaw Man"]="130",["Pocket Monsters"]="131",["Mahou Shoujo Madoka Magica"]="132",["Mahou Sensei Negima!"]="133",["Black Lagoon"]="134",["Queens Blade"]="135",["Nazo no Kanojo X"]="136",["Touhou Project"]="137",["Kantai Collection"]="138",["Girls Frontline"]="139",["Hyouka"]="140",["Mahouka Koukou no Rettousei"]="141",["K-On!"]="142",["Dagashi Kashi"]="143",["Wotaku Ni Koi Wa Muzukashii"]="145",["Overlord"]="146",["Persona"]="147",["Highschool DxD"]="148",["No Game No Life"]="149",["Gravity Falls"]="150",["The Idolmaster"]="151",["Tengen Toppa Gurren Lagann"]="152",["Shokugeki No Soma"]="153",["Tales of Xillia"]="154",["ToraDora!"]="155",["Akatsuki no Yona"]="156",["Love Plus"]="157",["Kimi no na wa"]="158",["Dynasty Warriors"]="159",["Monster Hunter"]="160",["Working!!"]="161",["Sekirei"]="162",["Dog Days"]="163",["Yotsubato!"]="164",["Ore no Imouto ga Konna ni Kawaii Wake ga Nai"]="165",["Nisekoi"]="166",["Star vs. the Forces of Evil"]="167",["Saki"]="168",["Dead or Alive"]="169",["Granblue Fantasy"]="170",["Enen no Shouboutai"]="171",["Tokyo 7th Sisters"]="172",["Dragons Crown"]="173",["Rewrite"]="174",["Boku wa Tomodachi ga Sukunai"]="175",["Kaichou wa Maid-sama!"]="176",["Shining Tears"]="177",["D-Frag"]="180",["Bokutachi wa Benkyou ga Dekinai"]="181",["Yahari Ore no Seishun Love Comedy wa Machigatteiru"]="182",["Suzumiya Haruhi no Yuutsu"]="183",["Princess connect! Re:Dive"]="184",["Super Mario Bros."]="185",["Steins;Gate"]="186",["Uzaki-chan wa Asobitai!"]="187",["Girls Und Panzer"]="188",["Watashi Ga Motenai No Wa Dou Kangaete Mo Omaera Ga Warui!"]="189",["Nekopara"]="190",["Kemono Friends"]="191",["Kanojo, Okarishimasu"]="192",["Nichijou"]="193",["Beelzebub"]="194",["Komi-san wa Komyushou Desu"]="195",["Overwatch"]="196",["Zootopia"]="197",["The Legend Of Zelda"]="198",["Eromanga sensei"]="200",["Stricke Witchers"]="202",["Saenai Heroine no Sodatekata"]="203",["Taisen Idol-Mahjong Final Romance"]="204",["Servant X Service"]="206",["Dragon Quest"]="208",["Helltaker"]="211",["Guilty Gear"]="212",["God Eater"]="213",["Ichiban Ushiro No Daimaou"]="214",["Denpa Onna to Seishun Otoko"]="215",["Outbreak Company"]="216",["Mahou Shoujo Lyrical Nanoha"]="217",["Rakuen Tsuihou: Expelled From Paradise"]="218",["Senjou No Valkyria"]="219",["Reco Love"]="220",["Utawarerumono"]="221",["ShinRa-Bansho"]="222",["To Heart"]="223",["Muv-Luv"]="224",["Kyoukai no Kanata"]="225",["Isekai Maou to Shoukan Shoujo no Dorei Majutsu"]="226",["Tate no Yuusha no Nariagari"]="227",["Jormungand"]="228",["Metroid"]="229",["Hunter ? Hunter"]="230",["Kami nomi zo Shiru Sekai"]="231",["Gabriel DropOut"]="232",["Harry Potter"]="233",["Monster Musume no Iru Nichijou"]="234",["Kore ga Watashi no Goshujin-sama"]="236",["Bakuon!!"]="237",["Dark Souls"]="238",["Yuri Yuri"]="240",["GJ-Bu"]="241",["Tenchi Muyou!"]="242",["SSSS.Gridman"]="243",["Maji de Watashi ni Koi Shinasai!"]="244",["Hayate no Gotoku!"]="245",["Fujiyama-san wa Shishunki"]="246",["Disgaea"]="247",["Koukyou Shihen Eureka Seven"]="248",["Dead By Daylight"]="249",["Yami to Boushi to Hon no Tabibito"]="250",["Nodame Cantabile"]="251",["Violet Evergarden"]="252",["Dirty Pair"]="253",["Hololive"]="254",["Kuttsukiboshi"]="255",["Kakuchou Shoujo-kei Trinary"]="256",["Shoujo Kakumei Utena"]="257",["Noir"]="258",["Yagate Kimi ni Naru"]="259",["BanG Dream!"]="260",["Taimanin Asagi"]="261",["Nanatsu no Taizai"]="262",["Golden Kamui"]="263",["Oshiete! Galko-chan"]="264",["Yuru Camp"]="265",["Hataraku Maou-sama!"]="266",["Hotel Hazbin"]="267",["How To Train Your Dragon"]="268",["Tsuujou Kougeki Ga Zentai Kougeki De Ni-Kai Kougeki No Okaa-San Wa Suki Desu Ka?"]="269",["Big Hero 6"]="270",["Himouto! Umaru-chan"]="271",["Hai to Gensou no Grimgar"]="273",["Cowboy Bebop"]="274",["Haiyore! Nyaruko-san"]="275",["Bijin Onna Joushi Takizawa-san!"]="276",["Tensei shitara Slime Datta Ken"]="277",["Sakurasou No Pet Na Kanojo"]="278",["Kishuku Gakkou No Juliet"]="279",["Ijiranaide, Nagatoro-san"]="280",["Binbougami Ga!"]="281",["Gleipnir"]="282",["Rakudai Kishi no Cavalry"]="283",["Rosario to Vampire"]="284",["Kyoukaisenjou No Horizon"]="285",["Prison School"]="286",["Witch Craft Works"]="287",["Kakegurui"]="288",["Kobayashi-san Chi no Maid Dragon"]="289",["Death March kara Hajimaru Isekai Kyousoukyoku"]="290",["Shimoneta To Iu Gainen Ga Sonzai Shinai Taikutsu Na Sekai"]="291",["Marvel Comics"]="292",["DC Comics"]="293",["Ookami to Koushinryou"]="294",["Ben 10"]="295",["Oshioki Sweetie"]="296",["Uma Musume: Pretty Derby"]="297",["Tokimeki Memorial"]="298",["KissXSis"]="299",["Koutetsujou no Kabaneri"]="300",["Honkai Gakuen"]="302",["Fushigi no Umi no Nadia"]="303",["Rurouni Kenshin: Meiji Kenkaku Romantan"]="304",["Ragnarok Online"]="305",["Taimanin Yukikaze"]="306",["Alien"]="307",["Оригинальные работы"]="308",["Dandy Demons"]="309",["Snow White"]="310",["Shingetsutan Tsukihime"]="311",["Resident Evil"]="312",["Servamp"]="313",["Osomatsu-san"]="314",["Majo no Tabitabi"]="315",["Onna Kaitou Silver Cat"]="316",["Magi: Labyrinth of Magic"]="318",["BlazBlue"]="319",["South Park"]="320",["The Evil Within"]="321",["High Speed!"]="322",["Kocchi Muite Waratte"]="323",["Barakamon"]="324",["Tales of Zestiria"]="325",["Kekkai Sensen"]="326",["Hidoku Shinai de"]="327",["Mobile Suit Gundam"]="328",["Banana Fish"]="329",["Touken Ranbu"]="330",["Ensemble Stars"]="332",["Aldnoah Zero"]="333",["Katekyo Hitman Reborn"]="334",["Black Butler"]="335",["Devil May Cry"]="336",["K-Project"]="337",["Log Horizon"]="338",["Togainu no Chi"]="339",["Ajin"]="340",["Escape Journey"]="341",["Yarichin Bitch Bu"]="343",["Mousou Elektel"]="344",["Teenage Mutant Ninja Turtles"]="345",["Hataraku Saibou"]="346",["IDOLiSH7"]="348",["The King's Avatar"]="349",["Shaman King"]="350",["Promare"]="351",["Otona Keikenshi"]="352",["Hoozuki no Reitetsu"]="353",["Inazuma Eleven"]="355",["Binan Koukou Chikyuu Boueibu LOVE"]="356",["No. 6"]="357",["Senyuu"]="358",["My Little Pony"]="359",["Ever After High"]="360",["Street Fighter"]="361",["Crash Bandicoot"]="362",["The  Flintstoons"]="363",["Star Wars"]="364",["W.I.T.C.H."]="365",["Little Red Riding Hood"]="366",["Star Fox"]="367",["Undertale"]="368",["Kung Fu Panda"]="369",["The Amazing World of Gumball"]="370",["Sora No Otoshimono"]="371",["Zero No Tsukaima"]="372",["Maoyuu Maou Yuusha"]="373",["Saijaku Muhai no Bahamut"]="374",["Hanebado!"]="375",["Bayonetta"]="376",["Kanokon"]="377",["Ghost in the Shell"]="378",["Incredibles"]="379",["Vandread"]="380",["Taiho Shichau zo"]="381",["Genshiken"]="382",["Kim Possible"]="383",["Slayers"]="384",["Hey arnold!"]="385",["Ookami-san to Shichinin no Nakama-tachi"]="386",["The Wonderful Wizard of OZ"]="387",["Suitopuru"]="388",["Medaka Kutusu"]="390",["Monster Girl Encyclopedia"]="391",["Shijou Saikyou no Deshi Kenichi"]="392",["Charlotte"]="393",["Doki Doki Literature Club!"]="394",["Voltron"]="395",["Wakfu"]="396",["Senran Kagura"]="397",["Vocaloid"]="398",["Fire Emblem Fates"]="399",["Pretty Cure"]="400",["Chip ’n Dale Rescue Rangers"]="401",["Nana to Kaoru"]="402",["Splatoon"]="403",["Bakugan Battle Brawlers"]="404",["Disney"]="405",["Mirai Nikki"]="406",["Monmusu"]="407",["Shinsekai yori"]="408",["Fallout"]="409",["Bamboo Blade"]="410",["Unlight"]="411",["RWBY"]="412",["Okusan"]="413",["Kashimashi: Girl Meets Girl"]="414",["Ikkitousen"]="415",["Houseki No Kuni"]="416",["Viper GTS"]="417",["Kanon"]="418",["Suisei no Gargantia"]="419",["Lara Croft"]="420",["Rance"]="421",["Skullgirls"]="422",["Lodoss-tou Senki"]="423",["Kannagi"]="424",["Hotel Transylvania"]="425",["Sono Hanabira ni Kuchizuke wo"]="426",["The Ring"]="427",["Sanoba Witch"]="428",["Kuroinu"]="429",["3-gatsu no Lion"]="430",["Ghostbusters"]="431",["Warhammer"]="432",["Maria-sama ga Miteru"]="433",["Uchuu Patrol Luluco"]="434",["World of Warcraft"]="435",["Tekken"]="436",["Ranma ?"]="437",["Ichigo 100%"]="438",["Rokka no Yuusha"]="439",["Subverse"]="440",["KimiKiss"]="441",["Dream C Club"]="442",["Sharin no Kuni, Himawari no Shoujo"]="443",["Demon’s Souls"]="444",["City Hunter"]="445",["Sound Voltex"]="446",["The King of Fighters"]="447",["The SCP Foundation"]="448",["Claymore"]="449",["Senki Zesshou Symphogear"]="450",["Chobits"]="451",["The Legend of Heroes"]="452",["Sekiro: Shadows Die Twice"]="453",["Dungeons & Dragons"]="454",["Fantasy Earth: Zero"]="455",["PlayerUnknown's Battlegrounds"]="456",["Macross Frontier"]="457",["Nurarihyon no Mago"]="458",["Kono Bijutsubu ni wa Mondai ga Aru!"]="459",["Machikado Mazoku"]="460",["Black Clover"]="461",["Zombie Land Saga"]="462",["Hyperdimension Neptunia"]="463",["Gakkougurashi!"]="464",["Shadowverse"]="465",["Saiyuki"]="466",["Kannazuki no Miko"]="467",["Shinryaku! Ika Musume"]="468",["Nijisanji"]="469",["Total Drama Island"]="471",["New Game!"]="472",["Jujutsu Kaisen"]="473",["Umineko no Naku Koro ni"]="474",["Миры Сильвер Соул"]="475",["Kampfer"]="476",["Re:Creators"]="478",["Baka to Test to Shoukanjuu"]="479",["Satsuriku no Tenshi"]="480",["Love Hina"]="481",["Ore wo Suki nano wa Omae dake ka yo"]="482",["Hinabita"]="483",["The Simpsons"]="484",["Xenoblade Chronicles"]="485",["Sarazanmai"]="486",["Family Guy"]="487",["The Cleveland Show"]="488",["Helluva Boss"]="489",["Futurama"]="490",["Dr. Stone"]="491",["Kara no Kyoukai"]="492",["Inu X Boku Ss"]="493",["Jaku-Chara Tomozaki-kun"]="494",["Blend S"]="495",["Va-11 Hall-a"]="496",["Kimi no Suizou wo Tabetai"]="497",["Mushoku Tensei: Isekai Ittara Honki Dasu"]="498",["Ziga"]="499",["Borderlands"]="500",["SK8"]="501",["No More Heroes"]="502",["Hellsing"]="503",["Rick and Morty"]="504",["DAYS"]="505",["The Witcher"]="506",["BioShock"]="507",["Left 4 Dead"]="508",["Captain Planet and the Planeteers"]="509",["My Life as a Teenage Robot"]="510",["Scooby-Doo"]="511",["The Fairly OddParents"]="512",["Totally Spies!"]="513",["Ninja Gaiden"]="514",["Soulcalibur"]="515",["The Legend of Korra"]="516",["Dexter's Laboratory"]="517",["The Summoning"]="518",["Silent Hill"]="519",["Soul Eater"]="520",["It"]="521",["Youkoso Jitsuryoku Shijou Shugi No Kyoushitsu E"]="522",["Digimon"]="523",["The Jungle Book"]="524",["Lilo and Stitch"]="525",["Koe no Katachi"]="526",["Koi wa Ameagari no You ni"]="527",["Duke Nukem"]="528",["Indiana Jones"]="529",["Minecraft"]="530",["Shantae"]="531",["Panty & Stocking with Garterbelt"]="532",["Getter Robo"]="533",["Kid Icarus"]="534",["Descendants"]="535",["Winnie-the-Pooh"]="536",["Genmu Senki Leda"]="537",["Chaos Breaker"]="538",["Boku no Kokoro no Yabai Yatsu"]="539",["Otome Game no Hametsu Flag shika Nai Akuyaku Reijou ni Tensei shiteshimatta..."]="540",["Toaru Majutsu No Index"]="541",["Sentouin, Hakenshimasu!"]="542",["Gate: Jieitai Kanochi nite, Kaku Tatakaeri"]="543",["The Founder of Diabolism"]="545",["Detroit: Become Human"]="546",["Prequel"]="547",["An American Tail"]="548",["Looney Tunes"]="549",["Shoujo?Kageki Revue Starlight"]="550",["Act-age"]="551",["Darkstalkers"]="552",["Musaigen No Phantom World"]="553",["StarCraft"]="554",["Coraline"]="555",["Mega man"]="556",["The Dragon Prince"]="557",["Wander over yonder"]="558",["Life is strange"]="559",["BNA: Brand New Animal"]="560",["Jackie Chan Adventures"]="561",["The Last of Us"]="562",["Miraculous: Tales of Ladybug & Cat Noir"]="563",["Mass Effect"]="564",["Beastars"]="565",["Foster's Home for Imaginary Friends"]="566",["Samurai Jack"]="567",["Danny Phantom"]="568",["Star Trek"]="569",["Ghosts’n Goblins"]="570",["The Elder Scrolls"]="571",["Scott Pilgrim"]="572",["Mortal Kombat"]="573",["The Loud House"]="574",["A Nightmare On Elm Street"]="575",["Inspector Gadget"]="576",["LazyTown"]="577",["Metal Gear Solid"]="578",["GANTZ"]="579",["Winx Club"]="580",["He-Man and the Masters of the Universe"]="581",["Final Fight"]="582",["Mighty Switch Force!"]="583",["Five Nights at Freddy's"]="584",["Halo"]="585",["Who Framed Roger Rabbit"]="586",["Senpai ga Urusai Kouhai no Hanashi"]="587",["Bakuman"]="588",["Streets Of Rage"]="590",["Kaifuku Jutsushi no Yarinaoshi"]="591",["Saya no Uta"]="592",["Sonic the Hedgehog"]="593",["Loonatics Unleashed"]="594",["Dragon Age"]="595",["G.I. Joe"]="596",["Legend Of Queen Opala"]="597",["Tsugumomo"]="598",["Brawl Stars"]="600",["Giant Killing"]="602",["07-Ghost"]="603",["Fugou Keiji: Balance:Unlimited"]="604",["Hades"]="605",["Helios Rising Heroes"]="606",["King’s Raid"]="607",["Pretty Rhythm"]="608",["Gorillaz"]="609",["Natsume Yuujinchou"]="610",["Punishing: Gray Raven"]="611",["The Jetsons"]="612",["Dota 2"]="613",["PayDay"]="614",["A3!"]="615",["Sherlock"]="616",["Whistle!"]="617",["Lucky Dog 1 Blast"]="618",["MapleStory"]="619",["Game of Thrones"]="620",["Lightning Warrior Raidy"]="621",["Kumo Desu ga, Nani ka?"]="622",["Samurai Pizza Cats"]="623",["Urusei Yatsura"]="625",["Yuragisou No Yuuna-san"]="626",["Ishuzoku Reviewers"]="627",["Johnny Test"]="628",["The Secret Saturdays"]="629",["Cthulhu Mythos"]="630",["Glitch Techs"]="631",["Mayoi Neko Overrun!"]="632",["TERA"]="633",["Mondaiji-tachi ga Isekai Kara Kuru Sou Desu yo?"]="634",["The Powerpuff Girls"]="635",["The Addams Family"]="636",["The Grim Adventures of Billy & Mandy"]="637",["The Lion King"]="638",["Shinmai Maou no Testament"]="639",["Star Ocean"]="640",["Kimi no Unaji ni Kanpai!"]="641",["Oda Nobuna no Yabou"]="642",["Arifureta Shokugyou de Sekai Saikyou"]="643",["Kujibiki?Unbalance"]="644",["Natsu no Kumo"]="645",["T.U.F.F. Puppy"]="646",["Upotte!!"]="647",["Kyuuketsuhime Miyu"]="648",["Etotama"]="649",["Ladies versus Butlers!"]="650",["Voiceroid"]="651",["Promise of Wizard"]="652",["Diabolik Lovers"]="653",["Namiuchigiwa no Muromi-san"]="654",["Ao no 6-gou"]="655",["Lotte no Omocha!"]="656",["Major"]="658",["Comic Party"]="659",["Little Nightmares"]="660",["She-Ra and the Princesses of Power"]="661",["Valorant"]="662",["Shuumatsu no Walkure"]="663",["Paladins"]="664",["Invader Zim"]="665",["Nemi"]="666",["Cats Don't Dance"]="667",["Heathcliff and the Catillac Cats"]="668",["Archie"]="669",["Josie and the Pussycats"]="670",["Ed, Edd n Eddy"]="671",["Kindaichi Shounen no Jikenbo"]="672",["Freedom Planet"]="673",["Spyro the Dragon"]="674",["Roskomnadzor-chan"]="675",["Crusaders Quest"]="676",["Elf-san wa Yaserarenai"]="677",["YuYu Hakusho"]="678",["Gravity Rush"]="679",["Seto no Hanayome"]="680",["OK K.O.! Let's Be Heroes"]="681",["SpongeBob SquarePants"]="682",["Kirby"]="683",["Haydee"]="684",["Trinity Seven"]="685",["Gunnm"]="687",["Murenase! Shiiton Gakuen"]="688",["Yuyushiki"]="689",["Tokyo Revengers"]="690",["Lucky?Star"]="691",["I''s"]="692",["Kotonoha no Niwa"]="693",["Chousoku Henkei Gyrozetter"]="694",["Toji no Miko"]="695",["Blue Archive"]="696",["Yo-kai Watch"]="697",["Mieruko-chan"]="698",["Mai-Otome"]="699",["Among Us"]="700",["Ghost Sweeper Mikami"]="701",["World Trigger"]="702",["Jaiden Animations"]="703",["Itai no wa Iya nano de Bougyoryoku ni Kyokufuri Shitai to Omoimasu"]="704",["Corruption of Champions"]="705",["Dragonaut: The Resonance"]="706",["Maria†Holic"]="707",["Sono Bisque Doll wa Koi o Suru"]="708",["Nagi no Asu Kara"]="709",["Papa no Iukoto wo Kikinasai!"]="710",["River City Girls"]="711",["Deltarune"]="712",["Getsuyoubi no Tawawa"]="713",["Princess Principal"]="714",["Hentai Ouji to Warawanai Neko"]="715",["Full Metal Daemon Muramasa"]="716",["Inside Job"]="717",["Villainous"]="718",["Eyeshield 21"]="719",["Houkago Play"]="720",["Kiseijuu: Sei no Kakuritsu"]="721",["Valkyrie Drive"]="722",["Trauma Center: Under the Knife"]="723",["Kore wa Zombie Desu ka?"]="724",["Disney Twisted-Wonderland"]="725",["Magical Halloween"]="726",["Spy x Family"]="727",["Druaga no Tou"]="728",["Homestuck"]="729",["Burn the Witch"]="730",["Cool World"]="731",["Yatterman"]="732",["Mana"]="733",["TwoKinds"]="734",["Sounan Desu ka?"]="735",["Poor Poor Lips"]="736",["Elden Ring"]="737",["Your Turn to Die"]="738",["Ar Tonelico"]="739",["DearS"]="740",["Tsukuyomi: Moon Phase"]="741",["Boku Girl"]="742",["World of Darkness"]="743",["Real mo Tamani wa Uso wo"]="744",["Mekakucity Actors"]="745",["Quiz Magic Academy"]="746",["Kawaii dake ja Nai Shikimori-san"]="747",["Kaijin Kaihatsu-bu no Kuroitsu-san"]="748",["Ase to Sekken"]="749",["Mouretsu Pirates"]="750",["Yandere Simulator"]="751",["Summer Wars"]="752",["Toki wo Kakeru Shoujo"]="753",["Shuukatsu Shippai shita Succubus-san wo Hiroimashita"]="754",["Bocchi Kaibutsu to Moumoku Shoujo"]="755",["Guardian Tales"]="756",["Hitsugi no Chaika"]="757",["Noragami"]="758",["NightS"]="759",["SoniAni: Super Sonico"]="760",["Lycoris Recoil"]="761",["Isekai Ojisan"]="762",["Bendy and the Ink Machine"]="763",["Portal"]="764",["Mabinogi"]="765",["Jinrou Judgement"]="766",["Raramagi Honyarara Magic"]="768",["High Key x Low Key"]="769",["Obey Me!"]="770",["Tennis no Ouji-sama"]="771",["Madagascar"]="772",["Sousou no Frieren"]="773",["Cyberpunk 2077"]="774",["Honzuki no Gekokujou: Shisho ni Naru Tame ni wa Shudan wo Erandeiraremasen"]="775",["Mairimashita! Iruma-kun"]="776",["Identity V"]="777",["Rozen Maiden"]="778",["Cloud Meadow"]="779",["Onii-chan wa Oshimai!"]="780",["Diablo"]="781",["Hatsune Miku: Colorful Stage!"]="782",["Saint Seiya"]="783",["Bocchi the Rock!"]="784",["Trigun"]="785",["Pop'n Music"]="786",["Sabita Yoru Demo Koi Wa Sasayaku"]="787",["Soulmate"]="788",["Kami-sama no Ude no Naka"]="789"}
Types={["Манга"]="1",["OEL-манга"]="4",["Манхва"]="5",["Маньхуа"]="6",["Руманга"]="8",["Комикс западный"]="9"}
Status={["Онгоинг"]="1",["Завершён"]="2",["Анонс"]="3",["Приостановлен"]="4",["Выпуск прекращён"]="5"}
Formats={["4-кома (Ёнкома)"]="1",["Сборник"]="2",["Додзинси"]="3",["В цвете"]="4",["Сингл"]="5",["Веб"]="6",["Вебтун"]="7"}

function update(url)
    local doc=network:load_as_Document(url)
    local json=JSONObject:create(doc:select("script"):toString():match("window.__DATA__ = (%b{})"))
    local ui=json:getObject("user"); if(ui) then ui=ui:get("id",-1); if(ui==-1) then ui=nil end end
    local jo=json:getObject("manga")
    local container=doc:selectFirst("div.media-container")
    local list=json:getObject("chapters"):getArray("list")
    local chapters=utils:to_list({})
    local branches=json:getObject("chapters"):getArray("branches")
    local translators={}
    for i=0,(branches~=nil and branches:size() or 0)-1,1 do
        local teams=branches:getObject(i):getArray("teams")
        for j=0,(teams~=nil and teams:size() or 0)-1,1 do
            local o=teams:get(j)
            translators[o:getInt("branch_id")]={[o:get("name")]=host.."/team/"..o:get("slug")}
        end
    end
    for i=list:size()-1,0,-1 do
        local o=list:getObject(i); local branch_id=o:get("branch_id",-1); if(branch_id==-1) then branch_id=nil end
        chapters:add(Chapter.new(o:get("chapter_volume"),o:get("chapter_number"),o:get("chapter_name"),utils:parseDate(o:get("chapter_created_at"),"yyyy-MM-dd' 'HH:mm:ss"),utils:to_map({["translators"]=translators[branch_id], ["bid"]=branch_id, ["ui"]=ui})))
    end
    local author=container:selectFirst("a[abs:href*=/people/]")
    return {
        ["url"]=url,
        ["url_web"]=url,
        ["name"]=jo:getString("name"),
        ["name_alt"]=jo:getString("rus_name"),
        ["author"]=author and {[utils:text(author)]=utils:attr(author,"abs:href")},
        ["genres"]=utils:text(container:select("a.media-tag-item"):select("a[href*=?genres]"),"",", "),
        ["tags"]=utils:text(container:select("a.media-tag-item"):select("a[href*=?tags]"),"",", "),
        ["status"]=container:select("a[href*=manga_status]"):attr("href"):match("manga_status.*=(%d)"),
        ["rating"]=num(container:selectFirst("div.media-rating__value"):text())/2,
        ["description"]=utils:attr(container:selectFirst("div.media-section_info"):getElementsByAttributeValue("itemprop","description"):first(),"content"),
        ["thumbnail"]=container:selectFirst("div.media-sidebar__cover.paper"):selectFirst("img"):attr("src"),
        ["chapters"]=utils:uniqueChapters(chapters,true),
        ["similar"]=similar(container:select("div.media-slider__item"))
    }
end

function query(name,page,params)
    local url=network:url_builder(host.."/manga-list"):add("name",name):add("page",page+1)
    if(params~=nil and #params>0) then
        if(type(params[1])=="userdata" and Options:equals(params[1]:getClass())) then
            url:add("sort",params[1]:getSelected()[1])
            url:add("dir",params[1]:getTitleSortSelected())
            url:add("chapters[min]",params[2]:getInputRangeStart())
            url:add("chapters[max]",params[2]:getInputRangeEnd())
            url:add("year[min]",params[3]:getInputRangeStart())
            url:add("year[max]",params[3]:getInputRangeEnd())
            url:add("rating[min]",params[4]:getInputRangeStart())
            url:add("rating[max]",params[4]:getInputRangeEnd())
            url:add("genres[include][]",params[5]:getSelected()):add("genres[exclude][]",params[5]:getDeselected())
            url:add("tags[include][]",params[6]:getSelected()):add("tags[exclude][]",params[6]:getDeselected())
            url:add("series[]",params[7]:getSelected())
            url:add("types[]",params[8]:getSelected())
            url:add("manga_status[]",params[9]:getSelected())
            url:add("format[include][]",params[10]:getSelected()):add("format[exclude][]",params[10]:getDeselected())
        else
            url:add("sort",sorts[params[1]])
        end
    end
    url=url:build()
    if(name~=nil and name:match("[a-z]://[^ >,;]*")~=nil) then url=name; end
    return query_url(url)
end

function query_url(url,page)
    if not url:find(host.."/team") then
        if page and page>0 then url=url:find("page=") and url:gsub("page=%d+","page="..tostring(page+1)) or url.."&page="..tostring(page+1) end
    end
    print(url)
    local doc=network:load_as_Document(url)
    local list={}
    if url:find(host.."/team") then
        local json=JSONObject:create(doc:select("script"):toString():match("window.__DATA__ = (%b{})")):get("team")
        local body=JSONObject.new():put("page",page and page+1 or 1):put("sort","rate"):put("dir","desc"):put("target","team"):put("targetValue",json:get("id"))
        json=JSONObject:create(network:load_as_String(host.."/api/list",{["X-Xsrf-Token"]=network:decode(network:getCookie(domain,"XSRF-TOKEN"))},body:toString(),"application/json; charset=utf-8")):get("items"):get("data")
        for i=0,json:size()-1,1 do
            local e=json:get(i)
            list[i]={
                ["url"]=e:get("href"),
                ["url_web"]=e:get("href"),
                ["name"]=e:get("name"),
                ["name_alt"]=utils:unescape_unicodes(e:get("rus_name")),
                ["thumbnail"]=e:get("covers"):get("default"):gsub("\\","/")
            }
        end
    else
        local selects=doc:selectFirst("div.media-cards-grid"):select("div.media-card-wrap")
        for i=0,selects:size()-1,1 do
            local e=selects:get(i)
            local f=e:selectFirst("a.media-card")
            list[i]={
                ["url"]=f:attr("abs:href"),
                ["url_web"]=f:attr("abs:href"),
                ["name"]=utils:text(e:selectFirst("h3")),
                ["name_alt"]=utils:text(e:selectFirst("h3")),
                ["thumbnail"]=select(1,f:attr("data-src"):gsub("^/",host.."/"))
            }
        end
    end
    return list
end

servers=nil

function getPages(url,chapter) -- table <Page>
    local scripts=network:load_as_Document(network:url_builder(url.."/v"..chapter["vol"].."/c"..chapter["num"]):add("page",1):add("bid",chapter["bid"]):add("ui",chapter["ui"]):build()):select("script")
    local json=JSONObject:create(scripts:toString():match("window.__info = (.-);"))
    local array=JSONArray:create(scripts:toString():match("window.__pg = (.-);"))
    servers=json:getObject("servers")
    local domain=json:getObject("servers"):getString(json:getObject("img"):getString("server")).."/"..json:getObject("img"):getString("url")
    local pages={}
    for i=0,array:size()-1,1 do
        local jo=array:getObject(i)
        pages[i]=Page.new(jo:getInt("p"),domain..jo:getString("u"))
    end
    return pages
end

function load(file,data,url,cancel,process)
    local error=network:load(network:getClient(),data,domain,file,cancel,process)
    if(error and error:getMessage()=="Length of data is zero") then
        for key,value in pairs(alt_urls(data)) do
            if(network:load(network:getClient(),value,domain,file,cancel,process)==nil) then
                return nil
            end
        end
    end
    return error
end

function alt_urls(url)
    return servers and {
        [1]=(string.gsub(url,"https?:[\\/][\\/][%w.-]+",servers:getString("secondary"))),
        [2]=(string.gsub(url,"https?:[\\/][\\/][%w.-]+",servers:getString("main"))),
        [3]=(string.gsub(url,"https?:[\\/][\\/][%w.-]+",servers:getString("compress"))),
        [4]=(string.gsub(url,"https?:[\\/][\\/][%w.-]+",servers:getString("fourth")))
    } or {}
end

function createAdvancedSearchOptions() -- table <Options>
    return {
        Options.new("Сортировка","desc","asc",utils:to_map(Sorts),0),
        Options.new("Количество глав",4),
        Options.new("Год выпуска",4),
        Options.new("Оценка",4),
        Options.new("Жанры",utils:to_map(Genres),2),
        Options.new("Теги",utils:to_map(Tags),2),
        Options.new("Серии",utils:to_map(Series),1),
        Options.new("Типы",utils:to_map(Types),1),
        Options.new("Статус тайтла",utils:to_map(Status),1),
        Options.new("Формат",utils:to_map(Formats),2)
    }
end

function similar(elements)
    local similar={}; local n=0
    for i=0,(elements and elements:size() or 0)-1,1 do
        local e=elements:get(i):selectFirst("a")
        local url=e and e:attr("abs:href")
        if(utils:text(e and e:selectFirst("span"))=="Ранобэ") then
            url=url:gsub(domain,"ranobelib.me")
        end
        similar[n]=e and {
            ["url"]=url,
            ["url_web"]=url,
            ["name"]=e:attr("title"),
            ["name_alt"]=e:attr("title"),
            ["thumbnail"]=select(1,e:selectFirst("div.manga-list-item__cover"):attr("style"):match("url%((.*)%)"):gsub("^/",host.."/"))
        }
        n=n+(e and 1 or 0)
    end
    return similar
end